# rAthena P2P Hosting Configuration

//================ Central Coordinator Server ================
p2p_coordinator: {
    // Main coordinator server settings
    enable: true
    ip: "coordinator.yourserver.com"
    port: 5121
    
    // Database proxy settings
    db_proxy: {
        port: 5122
        max_connections: 100
        connection_timeout: 30000  // ms
        retry_interval: 5000       // ms
    }
    
    // Host management
    host_management: {
        min_score_threshold: 75        // Minimum performance score to be eligible
        check_interval: 5000           // ms between health checks
        grace_period: 30000            // ms before marking host as failed
        max_players_per_host: 100
        host_rotation_interval: 3600    // seconds
    }
    
    // Failover settings
    failover: {
        enable_auto_failover: true
        failover_timeout: 5000         // ms
        max_retry_attempts: 3
        min_hosts_available: 2         // Minimum hosts before falling back to VPS
    }
}

//================ Map Distribution ================
map_config: {
    // Critical maps (always VPS hosted)
    critical_maps: [
        "prontera",
        "geffen",
        "payon",
        "alberta",
        "morocc",
        "izlude",
        "aldebaran",
        "comodo",
        "yuno",
        "amatsu",
        "gonryun",
        "umbala",
        "niflheim",
        "louyang",
        "new_gef",
        "pay_gld",
        "prt_gld",
        "alde_gld",
        "schg_cas01",
        "schg_cas02",
        "schg_cas03",
        "schg_cas04",
        "schg_cas05"
    ]
    
    // P2P eligible maps
    p2p_maps: {
        field_maps: true           // Regular field maps
        instance_maps: true        // Instance dungeons
        event_maps: true          // Event areas
        custom_maps: true         // Custom maps
        
        // Specific map exclusions from P2P hosting
        exclusions: [
            "guild_vs1",
            "guild_vs2",
            "guild_vs3",
            "guild_vs4",
            "guild_vs5"
        ]
    }
    
    // Map assignment settings
    assignment: {
        max_maps_per_host: 5
        rebalance_interval: 300    // seconds
        load_threshold: 80         // % before considering rebalance
    }
}

//================ Performance Requirements ================
host_requirements: {
    minimum: {
        cpu_cores: 4
        ram_gb: 8
        upload_mbps: 10
        latency_ms: 100
        uptime_minutes: 30
    }
    
    scoring: {
        cpu_weight: 30
        ram_weight: 25
        network_weight: 35
        stability_weight: 10
    }
}

//================ Security ================
security: {
    // Encryption settings
    encryption: {
        algorithm: "AES-256-GCM"
        key_rotation_interval: 86400    // seconds
        min_key_length: 32
    }
    
    // Authentication
    auth: {
        token_validity: 3600           // seconds
        max_failed_attempts: 5
        lockout_duration: 900          // seconds
    }
    
    // Rate limiting
    rate_limits: {
        max_connections_per_ip: 1000
        max_packets_per_second: 5000
        max_bandwidth_mbps: 100
    }
}

//================ Database Sync ================
database_sync: {
    // Sync settings
    sync_interval: 1000               // ms
    batch_size: 1000                  // records
    max_queue_size: 10000
    
    // Retry settings
    max_retries: 3
    retry_delay: 1000                 // ms
    
    // Conflict resolution
    conflict_resolution: {
        strategy: "last_write_wins"    // or "manual_resolution"
        notification_email: "admin@yourserver.com"
    }
}

//================ Monitoring ================
monitoring: {
    // Metrics collection
    metrics: {
        enable: true
        collection_interval: 5000      // ms
        retention_days: 30
    }
    
    // Alerting
    alerts: {
        enable: true
        notification_email: "admin@yourserver.com"
        
        thresholds: {
            cpu_usage: 90              // %
            memory_usage: 85           // %
            latency: 200              // ms
            error_rate: 5             // %
        }
    }
    
    // Logging
    logging: {
        level: "info"                 // debug, info, warn, error
        max_file_size: 100            // MB
        max_files: 10
        compress: true
    }
}