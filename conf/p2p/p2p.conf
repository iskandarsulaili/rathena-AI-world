// P2P Hosting Configuration

// Core settings
p2p: {
    // Enable P2P hosting system
    enabled: true
    
    // Coordinator server settings
    coordinator: {
        port: 5121
        max_connections: 1000
        update_interval: 100  // ms
        bind_ip: "0.0.0.0"
    }
    
    // Database proxy settings
    database: {
        port: 5122
        max_connections: 500
        cache_duration: 300  // seconds
        sync_interval: 5000  // ms
        required: true      // System needs database to work
    }
}

// Host selection settings
host_selection: {
    // Host types and roles
    host_types: {
        main_server: {
            priority: 1
            is_seed: true
            required: false  // System can work without main server
            auto_recovery: true
        }
        player_host: {
            priority: 2
            can_replace_main: true
            max_instances: 5  // Max maps per player host
            dynamic_allocation: true
        }
    }
    
    // Host eligibility criteria
    requirements: {
        // Base requirements for all hosts
        min_cpu_cores: 2
        min_cpu_frequency_mhz: 2000
        min_single_thread_score: 1500
        min_memory_mb: 2048
        min_free_memory_mb: 1024
        min_upload_mbps: 5
        min_download_mbps: 10
        max_latency_ms: 200
        max_jitter_ms: 50
        min_uptime_hours: 1
        min_storage_gb: 20
        min_free_storage_gb: 5
        
        // Higher requirements for primary hosts
        primary_host: {
            min_cpu_cores: 4
            min_memory_mb: 4096
            min_upload_mbps: 10
            min_stability_score: 0.98
        }
        
        // Stability requirements
        max_packet_loss_percent: 1.0
        min_stability_score: 0.95
        max_cpu_load_avg: 80
        
        // Hardware requirements
        required_cpu_features: [
            "SSE4.2",
            "AVX2"
        ]
        virtualization_allowed: false
    }
    
    // Selection weights
    weights: {
        performance_score: 0.4
        latency: 0.3
        reliability: 0.2
        capacity: 0.1
        stability_history: 0.2
        network_quality: 0.3
    }
    
    // Performance thresholds
    thresholds: {
        cpu_usage: 80
        memory_usage: 85
        memory_pressure: 70
        network_usage: 90
        io_pressure: 80
        connection_count: 1000
        bandwidth_usage: 75
        disk_io_usage: 70
        thread_usage: 85
        error_rate: 5
    }
}

// Failover settings
failover: {
    // Main server failover
    main_server: {
        backup_count: 3  // Number of player hosts ready to take over
        transition_timeout: 30  // seconds
        state_sync_interval: 5  // seconds
        allow_host_migration: true
    }
    
    // Player host failover
    player_host: {
        auto_migrate: true
        max_migration_time: 30  // seconds
        preserve_state: true
        verify_migration: true
    }
    
    // State handling
    state: {
        sync_enabled: true
        sync_interval: 5000  // ms
        verify_consistency: true
        backup_state: true
    }
}

// Performance validation
validation: {
    enabled: true
    test_duration_minutes: 10
    tests: {
        stress_test: true
        network_flood_test: true
        concurrent_players_test: true
        map_loading_test: true
        failover_test: true
    }
    
    // Host transition testing
    transition_tests: {
        enabled: true
        test_interval: 86400  // Daily
        simulate_main_failure: true
        verify_state_transfer: true
        measure_downtime: true
        max_allowed_downtime: 30  // seconds
    }
}

// Security settings
security: {
    // Encryption
    encryption: {
        enabled: true
        algorithm: "AES-256-GCM"
        key_rotation_interval: 3600
    }
    
    // Authentication
    auth: {
        token_validity: 3600
        max_failed_attempts: 5
        lockout_duration: 900
    }
    
    // Host verification
    host_verification: {
        verify_identity: true
        check_reputation: true
        validate_connectivity: true
    }
}

// Monitoring settings
monitoring: {
    enabled: true
    collection_interval: 5000
    metrics: {
        track_host_status: true
        monitor_transitions: true
        record_failures: true
        measure_availability: true
    }
}