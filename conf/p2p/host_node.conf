// P2P Host Node Configuration

// Node identity and basic settings
node: {
    // Node identification
    id: ""  // Will be assigned by coordinator
    name: "P2P-Host"
    type: "p2p"  // "p2p" or "vps"
    
    // Network settings
    network: {
        bind_ip: "0.0.0.0"
        port: 0  // Will be assigned by coordinator
        public_ip: ""  // Leave empty for auto-detection
        coordinator_address: "coordinator.example.com"
        coordinator_port: 5121
    }
    
    // Performance settings
    performance: {
        max_maps: 5
        max_players_per_map: 100
        total_max_players: 300
        update_interval: 50  // ms
    }
}

// Resource management
resources: {
    // CPU settings
    cpu: {
        max_usage: 80  // percentage
        reserved_cores: 1
        process_priority: "normal"  // low, normal, high
    }
    
    // Memory settings
    memory: {
        max_usage: 85  // percentage
        min_free: 512  // MB
        swap_threshold: 90  // percentage
    }
    
    // Network settings
    network: {
        max_bandwidth: 100  // Mbps
        buffer_size: 65536
        max_connections: 1000
    }
    
    // Storage settings
    storage: {
        min_free_space: 1024  // MB
        temp_directory: "/tmp/p2p-host"
        map_cache_size: 256  // MB
    }
}

// Game server settings
game_server: {
    // Map settings
    maps: {
        preload_maps: true
        cache_duration: 3600  // seconds
        unload_empty_timeout: 300  // seconds
    }
    
    // Entity settings
    entities: {
        max_mobs_per_map: 1000
        max_items_per_map: 1000
        view_range: 15  // cells
    }
    
    // AI settings
    ai: {
        enable_mob_ai: true
        enable_pet_ai: true
        update_interval: 250  // ms
    }
}

// Synchronization
sync: {
    // State sync
    state: {
        position_sync_interval: 50   // ms
        full_sync_interval: 5000    // ms
        partial_sync_interval: 1000  // ms
    }
    
    // Database sync
    database: {
        sync_interval: 5000  // ms
        batch_size: 1000
        retry_delay: 1000   // ms
    }
    
    // Entity sync
    entities: {
        movement_sync_interval: 100  // ms
        status_sync_interval: 1000   // ms
        action_sync_interval: 50     // ms
    }
}

// Security settings
security: {
    // Encryption
    encryption: {
        enabled: true
        method: "AES-256-GCM"
        key_file: "conf/p2p/keys/host.key"
    }
    
    // Authentication
    auth: {
        token_refresh_interval: 3600  // seconds
        verify_clients: true
        secure_communication: true
    }
    
    // Anti-cheat
    anti_cheat: {
        enabled: true
        position_check: true
        speed_check: true
        action_validation: true
    }
}

// Monitoring and metrics
monitoring: {
    // System metrics
    system_metrics: {
        enabled: true
        collection_interval: 5000  // ms
        report_interval: 30000     // ms
    }
    
    // Performance metrics
    performance_metrics: {
        enabled: true
        detailed_logging: false
        threshold_alerts: true
    }
    
    // Network metrics
    network_metrics: {
        enabled: true
        bandwidth_monitoring: true
        latency_monitoring: true
        connection_tracking: true
    }
}

// Failover settings
failover: {
    // Health checks
    health_check: {
        enabled: true
        interval: 5000      // ms
        timeout: 1000       // ms
        failure_threshold: 3
    }
    
    // Recovery
    recovery: {
        auto_recovery: true
        max_retry_count: 3
        retry_delay: 5000   // ms
    }
    
    // State handling
    state_handling: {
        save_state_interval: 60000  // ms
        keep_state_history: true
        max_state_age: 3600        // seconds
    }
}

// Debug settings
debug: {
    // Logging
    logging: {
        level: "info"  // debug, info, warn, error
        file: "log/p2p_host.log"
        max_size: 100      // MB
        max_files: 10
    }
    
    // Diagnostics
    diagnostics: {
        enabled: false
        packet_logging: false
        state_dumps: false
        performance_tracking: false
    }
    
    // Development
    development: {
        local_mode: false
        mock_coordinator: false
        disable_security: false
    }
}

// Advanced settings
advanced: {
    // Thread pools
    threads: {
        network_threads: 4
        worker_threads: 8
        async_task_threads: 2
    }
    
    // Buffers
    buffers: {
        packet_buffer: 65536
        map_buffer: 262144
        entity_buffer: 131072
    }
    
    // Optimizations
    optimizations: {
        use_packet_compression: true
        enable_state_caching: true
        optimize_network_usage: true
    }
    
    // Experimental
    experimental: {
        enable_predictive_spawning: false
        use_delta_compression: false
        dynamic_view_distance: false
    }
}