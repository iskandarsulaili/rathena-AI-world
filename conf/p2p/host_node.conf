# P2P Host Node Configuration

//================ Node Identity ================
node: {
    // Node identification
    name: "p2p_host_%HOSTNAME%"
    region: "asia"                    // asia, na, eu, sa, oce
    datacenter: "local"              // local, aws, gcp, azure
    
    // Capabilities
    capabilities: {
        max_maps: 5
        max_players: 100
        max_instances: 2
        support_pvp: false
    }
}

//================ Resource Management ================
resources: {
    // CPU allocation
    cpu: {
        max_usage: 80                 // %
        reserved_cores: 1
        priority_nice: -10
    }
    
    // Memory management
    memory: {
        max_usage: 85                 // %
        min_free: 2048               // MB
        swap_threshold: 90           // %
    }
    
    // Network settings
    network: {
        max_bandwidth: 100           // Mbps
        buffer_size: 8192           // bytes
        tcp_nodelay: true
        keepalive: true
    }
}

//================ Map Server Settings ================
map_server: {
    // Basic settings
    port: 5121
    map_cache_file: "db/map_cache.dat"
    enable_pet_ai: true
    enable_mob_ai: true
    
    // Performance settings
    max_connections: 1000
    update_interval: 50              // ms
    save_interval: 300              // seconds
    
    // Instance settings
    instance: {
        enable: true
        max_instances: 2
        expire_time: 3600           // seconds
    }
}

//================ Synchronization ================
sync: {
    // State sync
    state: {
        full_sync_interval: 300      // seconds
        delta_sync_interval: 1       // seconds
        batch_size: 1000
    }
    
    // Database sync
    database: {
        sync_interval: 1             // seconds
        max_queue_size: 10000
        retry_interval: 5            // seconds
    }
}

//================ Monitoring ================
monitoring: {
    // Performance monitoring
    metrics: {
        collection_interval: 1000     // ms
        report_interval: 5000        // ms
        
        tracked_metrics: [
            "cpu_usage",
            "memory_usage",
            "network_latency",
            "player_count",
            "packet_loss",
            "map_updates"
        ]
    }
    
    // Health checking
    health_check: {
        interval: 5000               // ms
        timeout: 3000               // ms
        failure_threshold: 3
        success_threshold: 2
    }
}

//================ Security ================
security: {
    // Authentication
    auth: {
        token_refresh_interval: 3600  // seconds
        verify_signatures: true
    }
    
    // Anti-cheat
    anti_cheat: {
        enable: true
        check_interval: 1000         // ms
        tolerance_threshold: 0.1     // Position desync tolerance
        
        validations: [
            "position",
            "speed",
            "damage",
            "item_acquisition"
        ]
    }
    
    // Rate limiting
    rate_limit: {
        max_packets: 5000            // per second
        max_connections: 1000        // per IP
        burst_tolerance: 1.5         // multiplier
    }
}

//================ Logging ================
logging: {
    // File logging
    file: {
        enable: true
        path: "log/p2p_host.log"
        level: "info"               // debug, info, warn, error
        max_size: 100              // MB
        max_files: 10
        compress: true
    }
    
    // Event logging
    events: {
        log_player_actions: true
        log_map_changes: true
        log_errors: true
        log_security: true
    }
}